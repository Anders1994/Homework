# Домашнее задание к занятию "SQL. Часть 2" - `Загурский Андрей`

### Задание 1

Одним запросом получите информацию о магазине, в котором обслуживается более 300 покупателей, и выведите в результат следующую информацию: 
- фамилия и имя сотрудника из этого магазина;
- город нахождения магазина;
- количество пользователей, закреплённых в этом магазине.

### *Ответ*:
```sql
SELECT
	s.first_name AS "Фамилия",
	s.last_name AS "Имя",
	c.city AS "Город",
	count(c2.first_name) AS "Кол-во пользователей"
FROM
	staff s
JOIN address a ON
	a.address_id = s.address_id
JOIN city c ON
	c.city_id = a.city_id
JOIN customer c2 ON
	c2.customer_id = c2.customer_id
GROUP BY
	c.city,
	s.first_name,
	s.last_name
HAVING
	count(c2.customer_id) > 300;
```
![image](https://github.com/Anders1994/Homework/blob/main/ScreenShots/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%20539.png)

---

### Задание 2

Получите количество фильмов, продолжительность которых больше средней продолжительности всех фильмов.

### *Ответ*:
```sql
SELECT
	count(*)
FROM
	film
WHERE
	`length` > (
	SELECT
		avg(LENGTH)
	FROM
		film);
```
![image](https://github.com/Anders1994/Homework/blob/main/ScreenShots/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%20540.png)
---

### Задание 3

Получите информацию, за какой месяц была получена наибольшая сумма платежей, и добавьте информацию по количеству аренд за этот месяц.

### *Ответ*:
```sql
SELECT
	MONTH(payment_date) AS "Месяц",
	sum(amount) AS "Сумма платежей",
	count(payment_id) AS "Кол-во аренд"
FROM
	payment
GROUP BY
	MONTH(payment_date)
ORDER BY
	sum(amount) DESC
LIMIT 1;
```
![image](https://github.com/Anders1994/Homework/blob/main/ScreenShots/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%20541.png)