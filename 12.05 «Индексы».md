# Домашнее задание к занятию "Индексы" - `Загурский Андрей`

### Задание 1

Напишите запрос к учебной базе данных, который вернёт процентное отношение общего размера всех индексов к общему размеру всех таблиц.

### *Ответ*:

```sql
SELECT
	concat(count(INDEX_LENGTH) / sum(DATA_LENGTH) * 100, '%') "Отношение"
FROM
	information_schema.tables;
```

![image](https://github.com/Anders1994/Homework/blob/main/ScreenShots/%D0%A1%D0%BA%D1%80%D0%B8%D0%BD%20544.png)

---

### Задание 2

Выполните explain analyze следующего запроса:
```sql
SELECT
	DISTINCT concat(c.last_name, ' ', c.first_name),
	sum(p.amount) OVER (PARTITION BY c.customer_id,
	f.title)
FROM
	payment p,
	rental r,
	customer c,
	inventory i,
	film f
WHERE
	date(p.payment_date) = '2005-07-30'
	AND p.payment_date = r.rental_date
	AND r.customer_id = c.customer_id
	AND i.inventory_id = r.inventory_id
```

- перечислите узкие места;
- оптимизируйте запрос: внесите корректировки по использованию операторов, при необходимости добавьте индексы.

### *Ответ*:
#### До
Запрос выполнился за 15.636 секунд, получено 200 строк

#### После
Запрос выполнился за *** секунд, получено 200 строк
